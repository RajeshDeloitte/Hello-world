<!--
--------------------------------------------------------------------------------------------------------------------------------
Author                                  Date                                            Description

---------------------------------------------------------------------------------------------------------------------------------
Vootla M Manoj                         23/11/2016                                  To display the credit card payment option
-->

<apex:page docType="html-5.0" sidebar="false" showHeader="false" standardStylesheets="false" applyHtmlTag="false">
<script id="PaymentCC-Both" type="text/template">
   <div class="ccPaymentOuterConatainer">
         <div class="main_content_large_right_container">
              <div class="alert alert-error ccPayment-MessagingSection-Error" style="display: none"></div>
        <form id="newCCForm" action="" class="newCCForm" forceSSL="true">
        <fieldset>
             <legend>New Credit Card</legend>
             <p>Enter your payment data below</p>
             <p><b> Card Type: </b>
             <select name="paymentType">
             <option value="Visa">Visa</option>
             <option value="MasterCard">Master Card</option>
             <option value="Amex">Amex</option>
             <option value="Discover">Discover</option>
             </select></p>
             <p><b>Card Number:</b> <input type="text" name="accountNumber"/></p>
             <p><b>Name on card:</b> <input type="text" name="nameoncard"/></p>
             <p><b>Expiry Date:</b> <input type="text" placeholder="MM/YYYY" name="expirydate"/></p>
             <p><b>CVV:</b> <input type="text" name="cvv"/></p>
        </fieldset>
        <br/>
            <p class="two_buttons">
                <div class="right">
                    <input type="button" class="button makePOPayment" id="save" data-id="newWalletForm" value="{{pageLabelMap 'Payment_MakePayment'}}" />
                </div>
            </p>
            <br/>
        </form>
        </div> 
    </div>
</script>

<script type="text/javascript">
   jQuery(function($){
     CCRZ.models.PaymentsCCModel = CCRZ.CloudCrazeModel.extend();
       CCRZ.views.PaymentsCCView = CCRZ.CloudCrazeView.extend({
                viewName : "PaymentsCCView",
                managedSubView : true,
                templateDesktop : CCRZ.util.template("PaymentCC-Both"),
                templatePhone : CCRZ.util.template("PaymentCC-Both"),
                init : function(options){
                    this.selector = options.selector;
                    this.render();
                    CCRZ.pubSub.trigger('action:paymentViewInit',this);
                },   
                events: {
                "click .makePOPayment" : "makePOPayment"
                },             
                parentPreRender : function(){
                    //Look for the instantiated iframe
                    //Detach it from the DOM
                    //Re-render the view but don't create the iframe
                    //Re-attach the iframe as appropriate in the rendered view
                },
                renderDesktop : function(){
                    this.setElement(this.selector);
                    this.data={};
                    this.$el.html(this.templateDesktop(this.data));
                },
                renderPhone : function(){
                    this.setElement(this.selector);
                    this.data={};
                    this.$el.html(this.templatePhone(this.data));
                },
                makePOPayment : function(event){
                var formName = $(event.target).data("id"); //'myWallet';
                var formData = form2js(formName, '.', false, function(node) {}, false);
                
                    formData.accountType = 'cc';
                    CCRZ.pubSub.trigger('action:processPayment', formData);
                 
                }
            });
            
         CCRZ.pubSub.trigger('action:paymentViewReady','cc',function(options){
            CCRZ.payment = CCRZ.payment||{views:{}};
            CCRZ.payment.views.cc = new CCRZ.views.PaymentsCCView({
                model : new CCRZ.models.PaymentsCCModel(),
                selector : options.selector
            });
        });   
     });
</script>
</apex:page>